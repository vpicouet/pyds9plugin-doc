<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://vpicouet.github.io/pyds9plugin-doc/feature/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Important features - pyds9plugin doc</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">pyds9plugin doc</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../install/" class="dropdown-item">Installation</a>
</li>
                                    
<li>
    <a href="../user/" class="dropdown-item">Tutorials</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Important features</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Videos</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../videos_multi/" class="dropdown-item">Multi-image processing</a>
</li>
            
<li>
    <a href="../videos_instru/" class="dropdown-item">Instrumentation</a>
</li>
            
<li>
    <a href="../videos_soft/" class="dropdown-item">Software</a>
</li>
            
<li>
    <a href="../videos_generic/" class="dropdown-item">Generic</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../philosophy/" class="dropdown-item">Development philosophy</a>
</li>
                                    
<li>
    <a href="../concept/" class="dropdown-item">Concept and implementation</a>
</li>
                                    
<li>
    <a href="../license/" class="dropdown-item">License</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../user/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../videos_multi/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#important-features" class="nav-link">Important features</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#command-line-access" class="nav-link">Command line access</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#multi-image-and-multi-threaded-analysis" class="nav-link">Multi-image and multi-threaded analysis</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#python-interpreter" class="nav-link">Python interpreter</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#python-macros" class="nav-link">Python macros</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#vtk-3d-rendering" class="nav-link">VTK 3D rendering</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#interactive-profile-fitting" class="nav-link">Interactive profile fitting</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#fits-file-organizer" class="nav-link">Fits file organizer</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#the-different-functions" class="nav-link">The different functions</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#generic-functions" class="nav-link">Generic functions</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#instrumentation" class="nav-link">Instrumentation</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#astronomical-software" class="nav-link">Astronomical software</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="important-features">Important features</h1>
<h2 id="command-line-access">Command line access</h2>
<p>As expressed above, <code>DS9</code> will execute a <code>Shell</code> command, which will
call the package's functions. <code>DS9</code> allows prompting this command each
time a function is launched through:
<code>Analysis -&gt; Analysis command log</code>. Copy-pasting this command into a
<code>Shell</code> interpreter (like Terminal) will provide the same result. The
package is then totally accessible via a <code>Shell</code> interpreter via command
lines.</p>
<p>This important feature could allow the plugin to be operated from other
image visualization software like Ginga or Glueviz. Running <code>DS9Utils</code>
inside the terminal will show all the available functions and running
<code>DS9Utils &lt;function&gt; -h</code> will display the help
(Figure <a href="#ds9/DS9Utils.jpg">[ds9/DS9Utils.jpg]</a>
) of the related function. This leads to
the next major feature: multi-image analysis.</p>
<p>All functions arguments are parsed through the <code>argparse</code> module.
Functions can then be called from <code>DS9</code>, terminal or directly from
Python using argv parameter:
<span class="arithmatex">\(<span class="arithmatex">\(\verb! Python_command(argv="-p '/data/**/*.fits' -e 'ds9-=1'")!  \label{eq:Python}\)</span>\)</span></p>
<p><img alt="caption" src="../fig/DS9Utils.jpg" /></p>
<h2 id="multi-image-and-multi-threaded-analysis">Multi-image and multi-threaded analysis</h2>
<p><code>pyds9plugin</code> is, in essence, a quick-look plugin that is perfect for
visualizing, exploring, analyzing, and processing the displayed image.
However, it was essential to make it suitable for more important
pipelines as soon as the parameters have been tuned. To this end, all
processing functions can be launched on a set of images by specifying
the path of all the images using regular expression:</p>
<p><code>DS9Utils &lt;function&gt; [-o OPTIONAL] --path "/data/**/*.fits"</code></p>
<p>This feature allows, for instance, to spend important time optimizing
interactively the <span class="arithmatex">\(\sim50\)</span> parameters of source extraction and add a
whole image folder to the analysis command to process all the images
when the parameters have been fine-tuned.</p>
<p>To take advantage of modern computer architectures, it uses
multi-threading to run each image on a different thread. The number of
processors to be used is accessible via <code>-N</code> or <code>--number_processors</code>
argument. By default, the code will use the total number of processors
of the machine minus 2. A video can be found .</p>
<h2 id="python-interpreter">Python interpreter</h2>
<p>We added a Python interpreter to the extension. This allows directly
applying Pythonic one-line transformations to the displayed image.</p>
<p>We list below some of the numerous one-line possibilities that can, for
instance, be used for generating some noise images, apply linear
transformation to images to decrease artificially your exposure time for instance), add noise to your image, mask bright sources, or perform more complex transformations like
fast Fourier transform or auto-correlation.</p>
<p><code>DS9 = np.median(ds9) + 0.1 (ds9-np.median(ds9))</code></p>
<p><code>ds9+=np.random.normal(0,0.5*ds9.std(),size=ds9.shape)</code></p>
<p><code>ds9+=np.random.normal(0,0.5*ds9.std(),size=ds9.shape)</code></p>
<p><code>ds9[ds9&gt;np.percentile(ds9,99)]=np.nan</code></p>
<p><code>ds9=abs(fftshift(fft2(ds9)))**2</code></p>
<p><code>ds9=correlate2d(ds9,ds9,boundary='symm', mode='same')</code></p>
<h2 id="python-macros">Python macros</h2>
<p>Because one line is short, it is possible to simply give the path of a
Python file. For instance, giving the path of the code below
interpolates masked values in the <code>DS9</code> frame and returns the new image
in the <code>DS9</code> GUI:</p>
<p>\
Basically, any function that does not require user's parameters can be
directly implemented this way which is simpler as multiprocessing is
already implemented. As well as for the previous section, the defined
function can be run on a set of images by adding the regular expression
path to the <code>--path</code> parameter (see
Section <a href="#Multi-image and multi-threaded analysis">3.1.2</a>
 and ):</p>
<p><code>DS9Utils python_command --exp "/softs/pipe.py" -p "/data/**/*.fits"</code></p>
<p>The different variables that can be used inside <em>macros</em> are <em>ds9</em> for
the image loaded in <code>DS9</code> and <em>header</em> for its header and <em>d</em> is the
<code>XPA</code> access point for a more extensive communication with <code>DS9</code>.</p>
<p>Following lessons learned from @Joye2005, I decided to include in
<code>DS9</code> analysis functions only the ones that are generic/helpful and that
require input parameters. Functions that do not require any parameter
should be implemented as macros as multiprocessing is already
implemented. To help people write their own, I published within the
plugin several macros (in <code>DS9functions/macros</code>). Each macro (<code>FFT.py</code>,
<code>Autocorrelation.py</code>, <code>trimming.py</code>, <code>Column_line_correlation.py</code>,
<code>Interpolate_NaNs.py</code>, etc.) can either contain one specific task
(compute and return the FFT of the <code>DS9</code> image, trim wcs images,
interpolate masked values in the image, etc.) or a series of processing
(background subtraction source extraction astrometric calibration)</p>
<pre><code class="language-python">from astropy.convolution import interpolate_replace_nans, Gaussian2DKernel

STD_DEV = 1
while ~np.isfinite(ds9).all():
  kernel = Gaussian2DKernel(x_stddev=STD_DEV, y_stddev=STD_DEV)
  \texttt{DS9} = interpolate_replace_nans(ds9, kernel)
  STD_DEV += 1
</code></pre>
<h2 id="vtk-3d-rendering">VTK 3D rendering</h2>
<p>The Visualization Toolkit (<code>VTK</code>) is the leading open-source software
for manipulating and displaying scientific data. It comes with
state-of-the-art tools for 3D rendering, a suite of widgets for 3D
interaction, and is already supported by some of the other applications
(<code>JS9</code>, <code>Icy</code>, <code>AstroImageJ</code>). We integrated it into the plugin to
increase the interaction with selected regions in the image. The
function allows to add contours, smooth the image rendering, change the
scale, or create a rotating <code>.gif</code> video. Possibility to even fit
interactively 2D Gaussians. It is also possible to analyze time series
in 3D like through-focus or to explore the focus in the field.</p>
<p><img alt="3D VTK rendering (see ). The different widgets in the bottom left corner allow to interact with the plotter and create animated
GIFs." src="../fig/3d.jpg" /></p>
<p><img alt="caption" src="../fig/3d3d.jpg" /></p>
<h2 id="interactive-profile-fitting">Interactive profile fitting</h2>
<p><code>DS9</code> incorporates the very useful possibility to interactively plot 1D
profiles (can be tilted, stacked in the orthogonal direction, plot the
third axis component, etc). This gives essential qualitative
information.</p>
<p>Because it is essential to retrieve information from images
(spatial/spectral resolution, diffusion exponential decay, etc.) it is
critical to turn this qualitative information into re-usable
quantitative information. To do this we added an interactive plot fitter
to the extension (based on the
<a href="https://GitHub.com/glentner/dataphile"><code>dataphile</code></a> package). This
allows fitting 1-D profiles with interactive adjustment of the initial
guess parameters to ensure that the fit converges. This function works
on any <code>DS9</code> plot, which means that plots generated via the plugin
(radial profile or light curve) can be fitted with this function.</p>
<p>As multi-feature analysis is essential in astronomy, the fitting is
decomposed into two components: the background and the features added to
the background. The different background possibles are constant, slope,
exponential, double-exponential, logarithmic. It is then possible to add
any number of features among Gaussian, Voigt, or Moffat profiles (see
Figure <a href="#ds9/fit2d.jpg">[ds9/fit2d.jpg]</a>
). Each feature parameter can be moved
independently to be sure that the final fit converges. The definition of
the different functions is shown in
table <a href="#functions">1</a>. To
get the most of this fitting function, we added the possibility to add
any other user-defined functions.</p>
<p>The function just needs to be added to the package file:\
<code>pyds9plugin/Macros/Fitting_Functions/functions.py</code></p>
<p>For each fitted parameter, be sure to define a list as default argument
as it will be used to define the lower and upper bounds of the widget
fitter.</p>
<p><img alt="caption" src="../fig/fit2d.jpg" /></p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Formula</th>
</tr>
</thead>
<tbody>
<tr>
<td>Constant</td>
<td><span class="arithmatex">\(y = a\)</span></td>
</tr>
<tr>
<td>Slope</td>
<td><span class="arithmatex">\(y=a \times x\)</span></td>
</tr>
<tr>
<td>Exponential</td>
<td><span class="arithmatex">\(y=a\times e^{-\frac{x}{b}}\)</span></td>
</tr>
<tr>
<td>Logarithmic</td>
<td><span class="arithmatex">\(y=a + b\times ln(x-c)\)</span></td>
</tr>
<tr>
<td>Double exponential</td>
<td><span class="arithmatex">\(y=a\times e^{-\frac{x}{b}} + c\times e^{-\frac{x}{d}}\)</span></td>
</tr>
<tr>
<td>Gaussian</td>
<td><span class="arithmatex">\(y=a \times e^{-(\frac{c-b}{2*c})^2}\)</span></td>
</tr>
<tr>
<td>Moffat</td>
<td><span class="arithmatex">\(y=a\times (1 + \frac{x-b}{c}^{2})^{-d}\)</span></td>
</tr>
<tr>
<td>Voight</td>
<td><span class="arithmatex">\(y=a \times\frac{  \mathbb{R}\left ( wofz \left (  \frac{(x-b) \gamma i}{c\sqrt{\pi}} \right ) \right )  }{  \mathbb{R}\left ( wofz \left (  \frac{x \gamma i}{c\sqrt{\pi}} \right ) \right ) }\)</span></td>
</tr>
</tbody>
</table>
<p>Fitting functions of the profile fitter. The first four functions
are the possible backgrounds to fit. On top of this background, you
can add as many Gaussian/Moffat/Voigt features as you want. The wofz
function in the last line is the Faddeeva function
<span class="arithmatex">\(wofz(z)=e^{-z^2} \times (1-erf(-iz) )\)</span> accessible in Python via
scipy.special.wofz</p>
<!-- :::  
  Function             Formula
  -------------------- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  Constant             $y = a$
  Slope                $y=a \cross x$
  Exponential          $y=a\cross e^{-\frac{x}{b}}$
  Logarithmic          $y=a + b\cross ln(x-c)$
  Double exponential   $y=a\cross e^{-\frac{x}{b}} + c\cross e^{-\frac{x}{d}}$
  Gaussian             $y=a \cross e^{-(\frac{c-b}{2*c})^2}$
  Moffat               $y=a\cross (1 + \frac{x-b}{c}^{2})^{-d}$
  Voight               $y=a \cross\frac{  \mathbb{R}\left ( wofz \left (  \frac{(x-b) \gamma i}{c\sqrt{\pi}} \right ) \right )  }{  \mathbb{R}\left ( wofz \left (  \frac{x \gamma i}{c\sqrt{\pi}} \right ) \right ) }$ -->
<!--
  : Fitting functions of the profile fitter. The first four functions
  are the possible backgrounds to fit. On top of this background, you
  can add as many Gaussian/Moffat/Voigt features as you want. The wofz
  function in the last line is the Faddeeva function
  $wofz(z)=e^{-z^2} \cross (1-erf(-iz) )$ accessible in Python via
  scipy.special.wofz
::: -->

<p>If no plot neither catalog is given, the window will work as a regular
plotter, where the user can plot its own function and change the
parameters.</p>
<p><img alt="caption" src="../fig/fit.jpg" /></p>
<h2 id="fits-file-organizer">Fits file organizer</h2>
<p>This final functionality is a fits organizer, divided into two functions
(Create header database and Filtering and organizing images). The first
function generates from the input images (regular expression) a catalog
(CSV table) concatenating all information contained in the header
images. It will also add important information such as the path,
directory, basename, creation and modification date, size, etc. of each
image.</p>
<p>The output database will give at a glance all image information which
will help understand the dataset, spot failures in the acquisition, etc.
It can also be open with <code>TOPCAT</code> to perform more complex analysis and
selection of images (See figure
 <a href="#ds9/files.jpg">[ds9/files.jpg]</a>
 )</p>
<p>As only header information is read (not the pixels), the function is
fast even on a significant number of files (a few seconds for thousands
of files). Still, it can be very interesting to add to the output header
catalog some image information such as the images' median, noise, the
number of saturated pixels, or any other information. To this end, the
function accepts <code>Header catalog Macros</code> where the user can write any
Python command to append image estimators to the output header catalog.
For instance, the following piece of code add to the header database
some information about the image (column/line correlation, saturated
pixels fraction, number of cosmic rays, etc.):</p>
<pre><code class="language-python">import numpy as np

SATURATION = 2 ** 16 -1
data = fitsfile[0].data
columns = np.nanmean(data, axis=1)
lines = np.nanmean(data, axis=0)
table['median'] = np.nanmedian(data)
table[&quot;Lines_difference&quot;] = np.nanmedian(lines[::2]) - np.nanmedian(lines[1::2])
table[&quot;Columns_difference&quot;] = np.nanmedian(columns[::2]) - np.nanmedian(columns[1::2])
table[&quot;SaturatedPixels&quot;] = 100 * np.mean(data &gt; SATURATION)
table[&quot;CosmicRays&quot;] = count_cosmic_rays(data)
</code></pre>
<p><img alt="caption" src="../fig/files.jpg" /></p>
<p>The output header database can be used with the second function, which
filters the images and organizes them following organizational rules.
This function allows creating subsets of images verifying some header
conditions. For instance, all images created after the 12th of September
2020 that have a positive EMGAIN or an exposure higher than 100 seconds
can be recovered with this condition: <span class="arithmatex">\(<span class="arithmatex">\(\renewcommand{\theequation}{6}
\verb! (EMGAIN &gt; 0 | EXPOSURE &gt;100) &amp; CreationTime&gt;200912 !  \label{eq:selection}\)</span>\)</span></p>
<p>The files are then directly organized in the file system with an
arborescence following the column names. For instance, by giving
<code>EMGAIN,EXPOSURE</code>, all files will get organized as shown in
figure <a href="#ds9/filter_files.jpg">[ds9/filter_files.jpg]</a>
. A video can be found . The function
only generates aliases and does not move any original files. The header
database and organized aliases are respectively saved in
<span class="arithmatex">\(\sim\)</span><code>/DS9QuickLookPlugIn/HeaderDataBase</code> and
<span class="arithmatex">\(\sim\)</span><code>/DS9QuickLookPlugIn/subsets</code>.</p>
<p><img alt="caption" src="../fig/filter_files.jpg" /></p>
<h1 id="the-different-functions">The different functions</h1>
<p>The functions are divided into three categories to help the organization
(see
Figure <a href="#ds9/commands.jpg">[ds9/commands.jpg]</a>
):\
Generic functions, instrumentation-related functions, and
astronomical-software-related functions. To make more accessible the
understanding of each function, they are possibly prefixed by three
badges:\
<strong>Boosting interaction:</strong> These functions are considered to improve the
interactivity between the user and the visualized data. This interaction
can be based on user-defined regions, interactive fitting, generation of
pickable metadata, etc.</p>
<p><strong>DS9 not required:</strong> The function is totally accessible via Terminal
independently from <code>DS9</code>, which means that the function does not need
<code>DS9</code> to be installed/open for being called. This can be interesting for
server users.</p>
<p><strong>Multi-image processing:</strong> The function, accessible via <code>Shell</code>
command, can be run on several images, and each analysis will run on a
different thread (See
section <a href="#Multi-image and multi-threaded analysis">3.1.2</a>)</p>
<p><img alt="caption" src="../fig/commands.jpg" /></p>
<h2 id="generic-functions">Generic functions</h2>
<p>This series of very general functions aims at filling some gaps of <code>DS9</code>
with stable generic functions (fitting, region-based functions), gaining
some time with key functions: (change display settings/lock parameters),
etc.</p>
<ul>
<li>
<p><strong>Change Display Parameters</strong> This basic function applies specific
    thresholding, scale, and colormap to the <code>DS9</code>-loaded image to give
    a quick and general visualization of the image. Accessible via one
    key hit (S), this allows exploring the full depth of the image
    quickly. More interestingly, the user can focus on a specific region
    of the image by creating and selecting a box or a circle on the
    region of interest ().</p>
</li>
<li>
<p><strong>Lock / Unlock Frames</strong> Access all the locking parameters of <code>DS9</code>
    frames at once to gain time: frame, crosshair, smooth, scale-limits,
    colorbar.</p>
</li>
<li>
<p><strong>Create Header DataBase</strong> Creates a catalog combining all meta-data
    information.</p>
</li>
<li>
<p><strong>Filtering &amp; organizing images</strong> Uses fits file database to create
    and order nicely filtered fits files
    (Section <a href="#Fits file organizer">3.1.7</a>)</p>
</li>
<li>
<p><strong>Macro / Python Command</strong> Interprets a Python command or file and
    applies it to given image(s)
    (Sections <a href="#Python interpreter">3.1.3</a></p>
<p>and <a href="#Python macros">3.1.4</a>
)</p>
</li>
<li>
<p><strong>Interactive 1D Fitting On Plot</strong> Fit interactively any <code>DS9</code> plot
    or catalog by different pre-defined functions
    (Section <a href="#Interactive profile fitting">3.1.6</a>
    )</p>
</li>
<li>
<p><strong>Fit Gaussian 2D</strong> Performs 2D Gaussian fitting on the encircled
    region in DS9. Opens up a VTK 3D plot of the encircled data. Any
    other feature can be fitted by selecting it (r). Each fit creates a
    region on the <code>DS9</code> GUI with the fit parameters of
    <code>astropy.modeling.functional_models.Gaussian2D</code> ().</p>
</li>
<li>
<p><strong>Trimming</strong> Cropping/Trimming function that keeps WCS header
    information.</p>
</li>
<li>
<p><strong>Open file(s)</strong> in <code>DS9</code> in an easier way. Possibility to enter the
    path of an image and a regular expression to open multiple files.
    Files can be open in the following format: Slice,
    Multi-frame-as-cube, multi-frame, RGB, Cube, PRISM.</p>
</li>
<li>
<p><strong>Plot Region In 3D</strong> See
    Section <a href="#VTK 3D rendering">3.1.5</a>
    , and
    Figures <a href="#ds9/3d.jpg">1</a></p>
<p>and <a href="#ds9/3d3d.jpg">[ds9/3d3d.jpg]</a></p>
</li>
<li>
<p><strong>Convert image</strong> Convert file into another type. The different
    types are (int8, int16, int32, int64, float32, float64) with the
    possibiity to rescale pixels value.</p>
<p><!-- <img alt="caption" src="./fig/logo.png" /> -->
<img alt="caption" src="../fig/python.jpg" /></p>
</li>
</ul>
<h2 id="instrumentation">Instrumentation</h2>
<p>This series of functions aims to assist instrument researchers during
assembly and testing with through-focus, light curves, centering,
radial, energy profile analysis, etc. More complex but general
processing functions (for detector characterization, for instance) can
be found in the macros (See
section <a href="#Python macros">3.1.4</a>
) like auto-correlation, fast Fourier
transform, smoothing, masking, interpolation, noise measurements, etc.</p>
<ul>
<li>
<p><strong>Centering (C)</strong> Centers <code>DS9</code> region encircling a spot. Five
    centroid methods are available: maximum, <span class="arithmatex">\(2\times1\)</span>1D fittin, 2D
    fitting, barycenter).</p>
</li>
<li>
<p><strong>Radial profile</strong> Compute and plot azimuthally averaged radial
    profile and energy profile of the encircled source in <code>DS9</code> after
    performing a re-centering. For extended sources, the source size can
    be informed to deconvolve the radial profile from the source
    (Figure <a href="#ds9/radial.jpg">[ds9/radial.jpg]</a>
    ).</p>
</li>
<li>
<p><strong>Throughfocus analysis</strong> Perform a through-focus analysis on a
    series of images and return different focus estimates as well as the
    3D evolution of the PSF
    (Figure <a href="#ds9/throughfocus.jpg">[ds9/throughfocus.jpg]</a>
    ).</p>
</li>
<li>
<p><strong>Explore PSFs/vignettes</strong> Explore PSFs/vignettes based on
    <code>SExtractor</code> catalog to visualize how it evolves in the field or
    with FWHM, magnitude, excentricity, angle or amplitude.</p>
</li>
<li>
<p><strong>Light curve</strong> Perform a light-curve analysis and returns the
    centered image.</p>
</li>
<li>
<p><strong>Extract Sources</strong> Extract sources from images(s) using photutils
    [@Bradley2016]</p>
</li>
<li>
<p><strong>Subtract Background</strong> Subtract background from images(s) using
    photutils</p>
</li>
<li>
<p><strong>Aperture photometry</strong> Computes photometry in given aperture(s)</p>
</li>
</ul>
<p><img alt="caption" src="../fig/fit2d.jpg" />
<img alt="caption" src="../fig/radial.jpg" />
<img alt="caption" src="../fig/throughfocus.jpg" /></p>
<h2 id="astronomical-software">Astronomical software</h2>
<p>The goal of this series of functions is to link the most essential
astronomical image processing software like the astromatic suite
(<code>SExtractor</code>, <code>Stiff</code>, <code>Swarp</code>, <code>PSFex</code> - need to be installed) and
offer them a parameter GUI.</p>
<ul>
<li>
<p><strong>Astrometric Calibration</strong> Uses <code>astrometry.net</code> to compute
    position on the sky and return WCS header. If regions are created
    (by hand or via <code>SExtractor</code>) and the parameter XY-catalog is set,
    only the position of the sources will be uploaded ().</p>
</li>
<li>
<p><strong><code>STIFF</code> - Color Images</strong> Run <code>STIFF</code> astromatic software
    [@Bertin2011a] to convert scientific FITS images to the more popular
    TIFF format for illustration purposes ().</p>
</li>
<li>
<p><strong><code>PSFex</code></strong> Run <code>PSFex</code> astromatic software [@Bertin2011] to
    extracts models of the Point Spread Function from FITS images
    processed with <code>SExtractor</code>, and measures the quality of images. The
    generated PSF models can be used for model-fitting photometry or
    morphological analyses.</p>
</li>
<li>
<p><strong><code>SExtractor</code></strong> Run <code>SExtraxtor</code> astromatic software [@Bertinl1996]
    to build a catalogue of objects from an astronomical image
    (Figure <a href="#ds9/sex.jpg">[ds9/sex.jpg]</a>
    ).</p>
</li>
<li>
<p><strong><code>Swarp</code></strong> Run <code>Swarp</code> software from <code>DS9</code> [@Bertin2010] to
    resample and co-add together FITS images using any astrometric
    projection defined in the WCS standard.</p>
</li>
<li>
<p><strong>Resample images</strong> Run part of <code>Swarp</code> astromatic software for
    resampling without co-addition.</p>
<p><img alt="caption" src="../fig/sex.jpg" /></p>
</li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../javascripts/mathjax.js" defer></script>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6" defer></script>
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
